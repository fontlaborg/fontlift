# fontlift TODO (2025-12-01)

- [x] Audit legacy `fontlift-mac-cli` and `fontlift-win-cli` commands/flags/behaviors and update `FEATURE_MATRIX.md` with a parity checklist.
- [x] Fix macOS build blockers (Core Text constants, CFDictionary construction) so `cargo test --workspace` passes on macOS; gate Windows code for non-Windows hosts.
- [x] Implement macOS install/uninstall/remove using Core Text register/unregister with scope options, safe copy to user/system dirs, conflict detection/auto-resolve, and system font protection.
- [x] Implement macOS listing via `CTFontManagerCopyAvailableFontURLs` with descriptor-based metadata and scope tagging.
- [x] Implement macOS cleanup (prune missing registrations + ATS/Adobe/Microsoft cache clearing) with `--prune-only`, `--cache-only`, `--admin` flags.
- [x] Add macOS simulation/dry-run + fake registry mode to mirror Swift testing features (`FONTLIFT_FAKE_REGISTRY_ROOT`, CLI `--dry-run`).
- [~] Implement Windows install/uninstall/remove using registry + GDI, file copy to per-user/system fonts, admin detection, and conflict auto-removal.
  - Conflict detection now auto-uninstalls conflicting registry/file entries before copying while protecting system font paths.
- [ ] Implement Windows listing from registry + fonts directory with metadata extraction, deduplication, and scope detection.
- [~] Implement Windows cleanup (registry prune, FontCache service reset, Adobe cache clearing) with `--prune-only`, `--cache-only`, `--admin` and exit-code parity.
  - Registry pruning and FontCache service stop/clear/start paths implemented; AdobeFnt*.lst purge added under Program Files; needs validation on a Windows host.
- [x] Add cross-platform conflict detection in `fontlift-core`; duplicate handling and system-font protection helpers added.
  - Conflict detection helper added and wired into Windows installs to auto-remove duplicate registrations/files before copying.
- [x] Expand CLI to match legacy ergonomics: aliases, batch file/dir installs, name- and path-based uninstall/remove, `-p/-n/-s`, `--json`, `--dry-run`, `--quiet/--verbose`, deterministic sorting, and help text updates.
- [x] Add CLI `list` JSON output with deterministic sorting and deduplication for repeat entries.
- [x] Add shell completion generation via `fontlift completions <shell>` and align exit codes with legacy binaries.
- [x] Expand Python bindings: typed `FontliftFontSource`/`FontliftFontFaceInfo` exposed to Python with `.dict()` for JSON; cleanup/prune/cache toggles added; name-based operations and Fire CLI parity completed.
- [x] Add `pyproject.toml` + packaging workflow for platform wheels; sync Python versioning with git tags via hatch-vcs.
- [ ] Create font fixtures (TTF/OTF/TTC) and golden-output recordings from legacy binaries for list/install/uninstall/remove/cleanup.
- [ ] Add Rust integration tests per platform with temp dirs and admin-check mocks; add Python `pytest` integration via `maturin develop`.
- [ ] Stand up CI matrix (macOS + Windows) running `cargo test`, CLI smoke tests with fixtures, and Python wheel build/test with coverage gates.
- [ ] Update README/USAGE/FEATURE_MATRIX with parity status, migration guide, and Python examples; refresh build script (`build.sh`) and Windows packaging docs.
- [ ] Publish release checklist, CHANGELOG entries, and keep WORK log updated alongside TODO status.
